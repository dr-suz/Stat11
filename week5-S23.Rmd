---
title: "Stat 11 Week 5"
subtitle: "Review of Unit 1" 
author: "Prof. Suzy Thornton"
date: "Spring 2023"
lang: "en-US"
output:
  html_document:
    df_print: paged
header-includes:
- \usepackage{amsmath}
- \usepackage{amssymb}
- \usepackage{amsfonts}
- \usepackage{xcolor}
---

# Unit 1 topics 

* Exploring and understanding data

* Exploring and understanding relationships between variables


# Week 1 - Visualizing and summarizing data 

* Data 

  * Observational units 

  * Variables - categorical or numeric - and their distributions 

* Analysis 

  * Confirmatory or exploratory 

  * Sample statistics 
  
## For categorical variables 

* Contingency tables and independence 

* <span style="color:green">Simpson's Paradox and lurking variables</span> 

## Example 

Below are the batting averages for Derek Jeter and David Justice for the 1995 and 1996 seasons, as well as their combined batting averages across the two seasons. Derek Jeter has a lower batting average in both 1995 and 1996, but a higher combined average. <span style="color:blue">What’s going on here?</span>


|  | 1995 | 1996 | Combined | 
|:--- |:--- |:--- |:--- |
| Derek Jeter | $0.250$ | $0.314$ | $0.310$ | 
| David Justice | $0.253$ | $0.321$ | $0.270$ | 


Simpson’s paradox - the imbalance of the groups that makes it possible for the overall average to be weighted differently then the trend in each subgroup. The lurking variable that we couldn't see if we just reported the proportions as in the table above is the number of times each player went up to bat in each year.


|  | 1995 | 1996 | Combined | 
|:--- |:--- |:--- |:--- |
| Derek Jeter | $0.250 = 12/48$ | $0.314=183/582$ | $0.310 = 195/630$ | 
| David Justice | $0.253=104/411$ | $0.321=45/140$ | $0.270=149/551$ | 



# Week 2 - Describing distributions of numeric variables with variance 


* Shape and measures of center and spread 

  * Mean vs median 
  
  * Variance vs IQR 

* Normal model and the 68/95/99.7% rule 

* Transforming variables 

  * Shifts and scales 
  
  * Standardization 

* Quantiles and quartiles  

  * Normal QQ Plots 

## Example 

Corey has 4929 songs in his computer's music library. The lengths of the songs have a mean of 242.4 seconds and standard deviation of 114.51 seconds with the accompanying Normal probability plot of song lengths.

![](./images/wk5-qqplot.png)

<span style="color:purple">Q: Is this distribution Normal? If not, how does it differ from a Normal model?</span>


# Week 3 - Describing relationships between two numeric variables 

* Simple linear regression model 

  * Predicted/fitted values and residuals 

  * Standard error of the residuals 

* Correlation and the coefficient of determination 

* Variable roles 

* Variable transformations

* <span style="color:green">Regression to the mean</span> 

## Example 

A CEO complains that the winners of his "rookie junior executive of the year" award often turn out to have less impressive performance the following year. He wonders whether the award actually encourages them to slack off. 

<span style="color:purple">Q: What is a better explanation for why the winners of the "rookie junior executive of the year" award often turn out to have less impressive performance the following year?</span>


## Example 

<span style="color:purple">Q: An online investment blogger advises investing in mutual funds that have performed badly the past year because "regression to the mean tells us that they will do well next year." Is she correct?</span> 



## Watch out for 

* <span style="color:green"><span style="color:green">Extrapolation</span> 

* Outliers, <span style="color:green">leverage</span>, and <span style="color:green">influence</span> 

  * Outliers don't seem to follow the trend of the majority of the data points. 
  
  * Leverage points are outliers with respect to the $x$-axis only  
  
  * Influential points are those data points that can drastically change the slope or intercept of the regression equation 

* Model assumptions met  

  * Linearity 
  
  * No outliers 
  
  * No thickening or thinning 


# Student Requested Examples 

## Contingency tables for two categorical variables 

### 1. Determining independence 

From pg 82 of your textbook: "variables are said to be independent if the conditional distribution of one variables is the same for each category of the other. We'll show how to check for independence in a later chapter." 



## Interpreting results of transformed data 

### 1. Comparing athletes' performance 

**200 $m$ race** $(x_1, \dots x_n)$

$\bar{x} =24.58s , \quad sd(x_1, \dots, x_n) = 0.654s$

Johnson-Thompson's time: $23.26s$

**Long jump** $(y_1, \dots, y_m)$ 

$\bar{y} = 6.17m , \quad sd(y_1, \dots, y_m) = 0.247m$ 

Thiam's distance: $6.58m$

### 2. Transformations in SLR models 


Recall our in-class example of fitting a SLR model to predict gator weight based on the length of alligators in areal photographs. 

The fitted regression equation was: $\hat{weight}_i = -393.26 + 5.90(length)$. Plotting the regression equation on top of the scatterplot of the original data indicates there is a problem with the assumption of a linear relationship between the variables length (in inches on a photograph) and weight (in lbs). 

```{r}
gators = read.csv("https://raw.githubusercontent.com/ProfSuzy/Stat11/main/Data/Gators.csv")

mod1 = lm(Weight.lbs. ~ Length.in., gators) 
summary(mod1)

plot(x=gators$Length.in., y=gators$Weight.lbs., xlab = "Length (in)", ylab="Weight (lbs)", main= "Original gator data")
abline(mod1, col="red")
```

Many of you explored this data further and discovered that a logarithmic transformation of the variable *inches* produces a scatterplot with a more linear trend. The fitted regression equation for the transformed data was: $\hat{\ln(weight)}_i = 1.34 + 0.04(length_i)$. The plot of the transformed data and fitted regression equation looks like a much better fit for a linear model. 

```{r}
mod2 = lm(log(Weight.lbs.) ~ Length.in., gators) 
summary(mod2)

plot(x=gators$Length.in., y=log(gators$Weight.lbs.), xlab = "Length (in)", ylab="log Weight (ln(lbs))", main= "Transformed gator data")
abline(mod2, col="red")
```

## Questions about SLR modeling 

### 1. When to use $r$ vs $R^2$? 

* The only difference between $r$ and $R^2$ for SLR models is that $r$ indicates not only the strength of a linear trend but also the direction of the trend. 

* $R^2$ has a convenient interpretation as the proportion of variation in the response, $Y$, that is explained by (or accounted for by) the predictor, $X$. 

* Both $r$ and $R^2$ are numerical summaries of strength of a relationship between two numeric variables; however, these summaries are only appropriate if the trend between the variables is **linear**. 

* In the gator model above, the regression model for the original data has a correlation coefficient of `r cor(gators$Length.in., gators$Weight.lbs.)` and an $R^2$ value of `r summary(mod1)$r.squared`. The regression model for the transformed data has a correlation coefficient of `r cor(gators$Length.in., log(gators$Weight.lbs.))` and an $R^2$ value of `r summary(mod1)$r.squared`. 

### 2. Formula for the slope of a SLR 

In the gator model above, the slope of the regression model for the original data is $5.90$ which means that, based on this model, each additional inch of length (in the areal photograph), corresponds to an additional weight of $5.9 lbs$.  


The slope of the regression model for the transformed data is a little more complicated to interpret. The slope of $0.04$ means that, based on this model, each additional inch of length (in the areal photograph) corresponds to an average increase in log(weight) of $0.04 \ln (lbs)$. (Note that since it is difficult to think in terms of logarithm of $lbs$, we would most likely want to report the interpretation of the slope within the context of the original units of the data. That is, each additional inch corresponds to a multiplicative increase in weight by `r exp(0.04)` $lbs$.)   


### 3. Normal QQ Plots to assess residuals 

A Normal QQ plot of the residuals for the regression model of the original gator data is shown below. 

```{r}
qqnorm(mod1$residuals)
qqline(mod1$residuals)
```

A Normal QQ plot of the residuals for the regression model of the transformed gator data is shown next.  

```{r}
qqnorm(mod2$residuals)
qqline(mod2$residuals)
```

Ideally, we'd see an rather strong linear trend between the sample quantiles of the residuals and the theoretical residuals from a standard Normal distribution. 


